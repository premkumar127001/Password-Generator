<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Password Generator</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    /* Reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', system-ui, sans-serif;
    }

    body {
      background: linear-gradient(90deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
      background-size: 400% 400%;
      animation: gradientBG 20s ease infinite;
    }

    @keyframes gradientBG {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    /* Main Container */
    .mainContainer {
      display: flex;
      justify-content: center;
      align-items: center;
      height: calc(100vh - 70px);
    }

    /* Inner Content Box */
    .contentBox {
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      background: #ffffffbb;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      width: 400px;
    }

    /* Password Display */
    .passwordDisplay {
      display: flex;
      align-items: center;
    }

    .strengthBar {
      height: 10px;
      background: #ffffff;
      border-radius: 6px;
    }

    /* Length */
    .lengthContainer label {
      font-weight: 500;
      display: block;
      margin-bottom: 0.3rem;
    }

    .lengthContainer input[type="range"] {
      width: 100%;
    }

    /* Options */
    .optionsContainer {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
      margin-top: 1rem;
      text-align: left;
      width: 100%;
      max-width: 300px;
    }

    .optionsContainer label {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 1rem;
      font-weight: 500;
      color: #2b2b2b;
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .optionsContainer label:hover {
      color: #3a6ff8;
    }

    /* Toast Notification */
    #toast {
      visibility: hidden;
      min-width: 260px;
      color: #fff;
      text-align: center;
      border-radius: 8px;
      padding: 12px 18px;
      position: fixed;
      z-index: 1000;
      left: 50%;
      bottom: 30px;
      transform: translateX(-50%);
      font-size: 1rem;
      opacity: 0;
      transition: opacity 0.4s ease, bottom 0.4s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    /* Toast visible state */
    #toast.show {
      visibility: visible;
      opacity: 1;
      bottom: 50px;
    }

    /* Toast color variants */
    #toast.success {
      background: linear-gradient(90deg, #4caf50, #2e7d32);
    }

    #toast.error {
      background: linear-gradient(90deg, #f44336, #d32f2f);
    }

    #toast.info {
      background: linear-gradient(90deg, #2196f3, #1976d2);
    }
  </style>
</head>

<body>
  <div class="mainContainer">
    <div class="contentBox">
      <h3 style="text-align: center;">Password Generator</h3>
      <!-- Password Display -->
      <div class="passwordDisplay">
        <input type="text" class="form-control" placeholder="Password" id="generatedPassword" readonly>
        <button class="btn btn-outline-success" title="Generate" id="generateBtn"><i
            class="fa-solid fa-repeat"></i></button>
        <button class="btn btn-outline-success" title="Copy" id="copyBtn"><i class="fa-solid fa-copy"></i></button>
      </div>
      
      <!-- Password Strength -->
      <div class="strengthContainer">
        <label>Password Strength: <span id="strengthLevel"></span></label>
        <div class="strengthBar" id="strengthBar"></div>
      </div>

      <!-- Password Length -->
      <div class="lengthContainer">
        <label for="length">Length: <span id="lengthValue">12</span></label>
        <input type="range" id="length" min="4" max="50" value="12" />
      </div>

      <!-- Options -->
      <div class="optionsContainer">
        <label><input type="checkbox" class="optionCheckbox" id="uppercase" checked /> Uppercase</label>
        <label><input type="checkbox" class="optionCheckbox" id="lowercase" checked /> Lowercase</label>
        <label><input type="checkbox" class="optionCheckbox" id="numbers" checked /> Numbers</label>
        <label><input type="checkbox" class="optionCheckbox" id="symbols" checked /> Symbols</label>
      </div>

    </div>
    <div id="toast"></div>
  </div>

  <script>
    // Character sets
    const upperCaseChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    const lowerCaseChars = "abcdefghijklmnopqrstuvwxyz";
    const numberChars = "0123456789";
    const symbolChars = "!@#$%^&*()_+-=[]{}|;:',.<>?/";

    // UI elements
    const passwordInput = document.getElementById("generatedPassword");
    const lengthSlider = document.getElementById("length");
    const lengthValue = document.getElementById("lengthValue");
    const strengthBar = document.getElementById("strengthBar");
    const strengthLevel = document.getElementById("strengthLevel");
    const generateBtn = document.getElementById("generateBtn");
    const copyBtn = document.getElementById("copyBtn");

    // Checkbox options
    const useUppercase = document.getElementById("uppercase");
    const useLowercase = document.getElementById("lowercase");
    const useNumbers = document.getElementById("numbers");
    const useSymbols = document.getElementById("symbols");

    // Weak password dictionary
    const weakPatterns = [
      /password/i, /passw0rd/i, /p@ssw(or)?d/i,
      /admin/i, /adm1n/i,
      /user/i, /test/i, /guest/i, /root/i,
      /letmein/i, /welcome/i, /login/i, /default/i,
      /iloveyou/i, /qwerty/i, /abc123/i, /pass123/i, /password1/i,
      /1234/, /12345/, /123456/, /0123/,
      /^(.)\1{3,}$/, /([0-9])\1{2,}/,
      /asdf/i, /zxcv/i, /qwer/i, /yuiop/i,
    ];

    // Update displayed length when slider changes
    lengthSlider.addEventListener("input", () => {
      lengthValue.textContent = lengthSlider.value;
      createPassword(); // regenerate dynamically
    });

    // Checks pattern for weak password
    function isWeakPattern(password) {
      return weakPatterns.some((pattern) => pattern.test(password));
    }

    // Fisherâ€“Yates shuffle for maximum randomness
    function shuffleString(str) {
      const arr = str.split("");
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]]; // swap
      }
      return arr.join("");
    }

    // Generate a random character from a string
    function getRandomChar(str) {
      return str[Math.floor(Math.random() * str.length)];
    }

    // Show toast message with type
    function showToast(message, type = "info") {
      const toast = document.getElementById("toast");

      // Remove any existing type class
      toast.className = "";
      toast.textContent = message;

      // Add proper type + show class
      toast.classList.add(type, "show");

      // Auto-hide after 2.5s
      setTimeout(() => {
        toast.classList.remove("show");
        setTimeout(() => toast.className = "", 400); // fully reset after animation
      }, 2500);
    }

    // Create password based on selected options
    function createPassword() {
      let charset = "";
      if (useUppercase.checked) charset += upperCaseChars;
      if (useLowercase.checked) charset += lowerCaseChars;
      if (useNumbers.checked) charset += numberChars;
      if (useSymbols.checked) charset += symbolChars;

      // Ensure at least one type is selected
      if (charset === "") {
        showToast("ðŸ˜Ž Brooo... pick one option at least!", "error");
        strengthLevel.textContent = "";
        strengthBar.style.background = "#ffffff";
        passwordInput.value = "";
        return;
      }

      let password = "";
      const length = parseInt(lengthSlider.value);

      // Keep generating until it's not weak
      do {
        password = "";
        const shuffledCharset = shuffleString(charset); // ðŸŒ€ New line
        for (let i = 0; i < length; i++) {
          password += getRandomChar(shuffledCharset);
        }
      } while (isWeakPattern(password)); // ðŸ”¥ ensure we skip weak patterns

      passwordInput.value = password;
      updateStrength(password);
    }

    // Check password strength
    function updateStrength(password) {
      let score = 0;

      if (password.length >= 8) score++;
      if (password.length >= 12) score++;
      if (/[A-Z]/.test(password)) score++;
      if (/[0-9]/.test(password)) score++;
      if (/[^A-Za-z0-9]/.test(password)) score++;

      // Set strength level
      const strength = ["Weak", "Medium", "Strong", "Very Strong"];
      let level = "";
      let color = "";

      if (score <= 2) {
        level = strength[0];
        color = "#f44336"; // red
      } else if (score === 3) {
        level = strength[1];
        color = "#ff9800"; // orange
      } else if (score === 4) {
        level = strength[2];
        color = "#4caf50"; // green
      } else {
        level = strength[3];
        color = "#2e7d32"; // dark green
      }

      strengthLevel.textContent = level;
      strengthBar.style.background = color;
    }

    // Copy to clipboard
    copyBtn.addEventListener("click", () => {
      if (!passwordInput.value) return;
      passwordInput.select();
      document.execCommand("copy");
      showToast("âœ… Password copied!", "success");
    });

    // Attach one listener to all option checkboxes
    document.querySelectorAll(".optionCheckbox").forEach(cb => {
      cb.addEventListener("change", createPassword);
    });

    // Regenerate password on button click
    generateBtn.addEventListener("click", createPassword);

    // Create password on page load
    window.addEventListener("load", createPassword);

  </script>
</body>

</html>